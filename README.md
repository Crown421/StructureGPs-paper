# StructureGPs-paper

This repository contains the code for the paper 
*Learning ODE Models with Qualitative Structure Using Gaussian Processes* [(arXiv:2011.05364)](https://arxiv.org/abs/2011.05364). 

The packages in this repository will very soon be superseded by [GPDiffEq.jl](https://github.com/Crown421/GPDiffEq.jl).

## Setup
This code is compatible with Julia 1.5 To recreate the environment open a terminal in the repository and run

```shell
    julia --project
```

or within julia
```julia
    ] activate .
```

Then run 
```
    ] instantiate
```
to install and build all packages in the environment. 

## Examples

The paper covers two examples, a simple spiral ODE and the Kepler problem.
### Spiral ODE
The plots below are produced by the `plots_spiral.jl` script, and written out into the `plots` directory. The plots are generated via precomputed data from the `data` directory. 

The data can be regenerated by running the `setup_spiral.jl` script. Note that the computations are set up to be [multi-threaded](https://docs.julialang.org/en/v1/manual/multi-threading/), and took about 30min on 12 threads. In addition, they require substantial RAM, at about 18Gb when using 12 threads. 

![Plot1](/plots/cubedODE.png)

![Plot2](/plots/longterm.png)

### Kepler Problem

The plot below is produced by the `plots_kepler.jl` script, and written out into the `plots` directory. The plot is generated via precomputed data from the `data` directory. 

The data can be regenerated by running the `setup_kepler.jl` script. 

![Kepler](/plots/kepler.png)